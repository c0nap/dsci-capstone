conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ make docker-python-dev
[+] Building 2.1s (22/22) FINISHED                                                                       docker:default
 => [internal] load build definition from python.dockerfile                                                        0.0s
 => => transferring dockerfile: 1.54kB                                                                             0.0s
 => [internal] load metadata for docker.io/library/python:3.12-slim                                                0.4s
 => [internal] load .dockerignore                                                                                  0.1s
 => => transferring context: 79B                                                                                   0.0s
 => [ 1/17] FROM docker.io/library/python:3.12-slim@sha256:590cad70271b6c1795c6a11fb5c110efca593adbd0d4883cd19c36  0.0s
 => [internal] load build context                                                                                  0.7s
 => => transferring context: 10.72MB                                                                               0.7s
 => CACHED [ 2/17] WORKDIR /pipeline                                                                               0.0s
 => CACHED [ 3/17] RUN apt-get update && apt-get install -y --no-install-recommends     build-essential     make   0.0s
 => CACHED [ 4/17] COPY deps/requirements.txt .                                                                    0.0s
 => CACHED [ 5/17] RUN pip install --no-cache-dir -r requirements.txt                                              0.0s
 => CACHED [ 6/17] RUN python -m spacy download en_core_web_sm                                                     0.0s
 => CACHED [ 7/17] RUN python -m nltk.downloader punkt punkt_tab stopwords                                         0.0s
 => CACHED [ 8/17] COPY src/ src/                                                                                  0.0s
 => CACHED [ 9/17] COPY tests/ tests/                                                                              0.0s
 => CACHED [10/17] COPY smoke/ smoke/                                                                              0.0s
 => CACHED [11/17] COPY datasets/ datasets/                                                                        0.0s
 => CACHED [12/17] COPY .env .env                                                                                  0.0s
 => CACHED [13/17] COPY Makefile .                                                                                 0.0s
 => CACHED [14/17] RUN make env-docker                                                                             0.0s
 => CACHED [15/17] RUN mv .env.docker .env                                                                         0.0s
 => CACHED [16/17] COPY pyproject.toml pytest.ini conftest.py .                                                    0.0s
 => CACHED [17/17] COPY logs/elapsed_time.csv logs/                                                                0.0s
 => exporting to image                                                                                             0.1s
 => => exporting layers                                                                                            0.0s
 => => writing image sha256:360328d6393906d33a4e8841999d45cac8e8ab52008974077308de6cb2657fd2                       0.1s
 => => naming to docker.io/library/dsci-cap-img-python-dev:latest                                                  0.0s
container-python
b170dfc22b3d3b856c5c726b589e5a485b7fe7901377fad974bd6ae38a0000dc
Network 'capstone_default' already exists; continue...
^Cmake[2]: *** [Makefile:77: docker-start] Interrupt
make[1]: *** [Makefile:89: docker-python] Interrupt
make: *** [Makefile:137: docker-python-dev] Interrupt

conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ make docker-python-dev
[+] Building 3.1s (22/22) FINISHED                                                                       docker:default
 => [internal] load build definition from python.dockerfile                                                        0.0s
 => => transferring dockerfile: 1.54kB                                                                             0.0s
 => [internal] load metadata for docker.io/library/python:3.12-slim                                                0.5s
 => [internal] load .dockerignore                                                                                  0.0s
 => => transferring context: 79B                                                                                   0.0s
 => [internal] load build context                                                                                  0.6s
 => => transferring context: 21.16kB                                                                               0.6s
 => [ 1/17] FROM docker.io/library/python:3.12-slim@sha256:590cad70271b6c1795c6a11fb5c110efca593adbd0d4883cd19c36  0.0s
 => CACHED [ 2/17] WORKDIR /pipeline                                                                               0.0s
 => CACHED [ 3/17] RUN apt-get update && apt-get install -y --no-install-recommends     build-essential     make   0.0s
 => CACHED [ 4/17] COPY deps/requirements.txt .                                                                    0.0s
 => CACHED [ 5/17] RUN pip install --no-cache-dir -r requirements.txt                                              0.0s
 => CACHED [ 6/17] RUN python -m spacy download en_core_web_sm                                                     0.0s
 => CACHED [ 7/17] RUN python -m nltk.downloader punkt punkt_tab stopwords                                         0.0s
 => [ 8/17] COPY src/ src/                                                                                         0.1s
 => [ 9/17] COPY tests/ tests/                                                                                     0.1s
 => [10/17] COPY smoke/ smoke/                                                                                     0.0s
 => [11/17] COPY datasets/ datasets/                                                                               0.0s
 => [12/17] COPY .env .env                                                                                         0.0s
 => [13/17] COPY Makefile .                                                                                        0.0s
 => [14/17] RUN make env-docker                                                                                    0.5s
 => [15/17] RUN mv .env.docker .env                                                                                0.3s
 => [16/17] COPY pyproject.toml pytest.ini conftest.py .                                                           0.1s
 => [17/17] COPY logs/elapsed_time.csv logs/                                                                       0.1s
 => exporting to image                                                                                             0.3s
 => => exporting layers                                                                                            0.2s
 => => writing image sha256:ef23cc14c6c736e226f5e9fa7ba5e7224975b50e32d38cd3de86a9964ef3c0ff                       0.0s
 => => naming to docker.io/library/dsci-cap-img-python-dev:latest                                                  0.0s
container-python
8529d5a0ac2783e40579a330784cbfb9a48f133bfded42832973e044415a424d
Network 'capstone_default' already exists; continue...
Deleted old chunks...
 * Serving Flask app 'src.core.boss'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5054
 * Running on http://172.17.0.5:5054
Press CTRL+C to quit
[STATUS] Story 1: preprocessing -> in-progress
127.0.0.1 - - [09/Dec/2025 15:00:47] "POST /status/story HTTP/1.1" 200 -
[STATUS] Story 1: chunking -> in-progress
127.0.0.1 - - [09/Dec/2025 15:00:47] "POST /status/story HTTP/1.1" 200 -

==================================================
Processing: ./tests/examples-pipeline/epub/trilogy-wishes-2.epub
[TIME] task_01_convert_epub took 1.745s
[TIME] task_02_parse_chapters took 0.028s
[TIME] task_03_chunk_story took 0.015s

=== STORY SUMMARY ===
Total chunks: 254
[TIME] pipeline_A took 1.855s
[STATUS] Story 1: preprocessing -> completed
127.0.0.1 - - [09/Dec/2025 15:00:48] "POST /status/story HTTP/1.1" 200 -
[STATUS] Story 1: chunking -> completed
127.0.0.1 - - [09/Dec/2025 15:00:48] "POST /status/story HTTP/1.1" 200 -

Chunk details:
  index: 18

‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’
‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. That book ought to be destroyed. It’s most inaccurate. The rest of my body was never purple, and as for my—tail—well, I simply ask you, IS it white?’
It turned round and gravely presented its golden tail to the children.
‘No, it’s not,’ said everybody.
‘No, and it never was,’ said the Phoenix. ‘And that about the worm is just a vulgar insult. The Phoenix has an egg, like all respectable birds. It makes a pile—that part’s all right—and it lays its egg, and it burns itself; and it goes to sleep and wakes up in its egg, and comes out and goes on living again, and so on for ever and ever. I can’t tell you how weary I got of it—such a restless existence; no repose.’
‘But how did your egg get HERE?’ asked Anthea.
[TIME] task_11_send_chunk took 0.025s
    [Inserted chunk into Mongo with chunk_id: story-1_book-2_chapter-6_p.74132]
[TIME] task_12_relation_extraction[textacy] took 1.269s

NLP output:
{'s': 'They', 'r': 'say', 'o': 'it itself worm'}
{'s': 'it', 'r': 'lives', 'o': 'years'}
{'s': 'it', 'r': 'builds', 'o': 'pile'}
{'s': 'They', 'r': 'fires', 'o': 'it'}
{'s': 'They', 'r': 'burns', 'o': 'itself'}
{'s': 'They', 'r': 'arises', 'o': 'worm'}
{'s': 'which', 'r': 'grows', 'o': 'to be a Phoenix'}
{'s': 'they', 'r': 'gave', 'o': 'what'}
{'s': 'They', 'r': 'never gave', 'o': 'much'}
{'s': 'who', 'r': 'gave', 'o': 'nothing'}
{'s': 'I', 'r': 'ask', 'o': 'you'}
{'s': 'It', 'r': 'turned', 'o': 'tail'}
{'s': 'It', 'r': 'presented', 'o': 'tail'}
{'s': 'Phoenix', 'r': 'has', 'o': 'egg'}
{'s': 'It', 'r': 'makes', 'o': 'pile'}
{'s': 'it', 'r': 'lays', 'o': 'egg'}
{'s': 'it', 'r': 'burns', 'o': 'itself'}
{'s': 'it', 'r': 'goes', 'o': 'pile egg itself'}
{'s': 'I', 'r': 'ca n’t tell', 'o': 'you'}

[TIME] task_14_validate_llm[openai] took 5.845s

    LLM prompt:
Here are some semantic triples extracted from a story chunk:
{'s': 'They', 'r': 'say', 'o': 'it itself worm'}
{'s': 'it', 'r': 'lives', 'o': 'years'}
{'s': 'it', 'r': 'builds', 'o': 'pile'}
{'s': 'They', 'r': 'fires', 'o': 'it'}
{'s': 'They', 'r': 'burns', 'o': 'itself'}
{'s': 'They', 'r': 'arises', 'o': 'worm'}
{'s': 'which', 'r': 'grows', 'o': 'to be a Phoenix'}
{'s': 'they', 'r': 'gave', 'o': 'what'}
{'s': 'They', 'r': 'never gave', 'o': 'much'}
{'s': 'who', 'r': 'gave', 'o': 'nothing'}
{'s': 'I', 'r': 'ask', 'o': 'you'}
{'s': 'It', 'r': 'turned', 'o': 'tail'}
{'s': 'It', 'r': 'presented', 'o': 'tail'}
{'s': 'Phoenix', 'r': 'has', 'o': 'egg'}
{'s': 'It', 'r': 'makes', 'o': 'pile'}
{'s': 'it', 'r': 'lays', 'o': 'egg'}
{'s': 'it', 'r': 'burns', 'o': 'itself'}
{'s': 'it', 'r': 'goes', 'o': 'pile egg itself'}
{'s': 'I', 'r': 'ca n’t tell', 'o': 'you'}

And here is the original text:
‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’
‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. That book ought to be destroyed. It’s most inaccurate. The rest of my body was never purple, and as for my—tail—well, I simply ask you, IS it white?’
It turned round and gravely presented its golden tail to the children.
‘No, it’s not,’ said everybody.
‘No, and it never was,’ said the Phoenix. ‘And that about the worm is just a vulgar insult. The Phoenix has an egg, like all respectable birds. It makes a pile—that part’s all right—and it lays its egg, and it burns itself; and it goes to sleep and wakes up in its egg, and comes out and goes on living again, and so on for ever and ever. I can’t tell you how weary I got of it—such a restless existence; no repose.’
‘But how did your egg get HERE?’ asked Anthea.

Output JSON with keys: s (subject), r (relation), o (object).
Remove nonsensical triples but otherwise retain all relevant entries, and add new ones to encapsulate events, dialogue, and core meaning where applicable.

    LLM output:
[
  {"s": "They", "r": "say", "o": "that it lives about five hundred years in the wilderness"},
  {"s": "it", "r": "lives", "o": "about five hundred years in the wilderness"},
  {"s": "it", "r": "builds", "o": "a pile of sweet wood and aromatic gums"},
  {"s": "They", "r": "fire", "o": "the pile"},
  {"s": "They", "r": "burns", "o": "itself"},
  {"s": "from its ashes", "r": "arises", "o": "a worm"},
  {"s": "worm", "r": "grows", "o": "to be a Phoenix"},
  {"s": "Phoenix", "r": "has", "o": "an egg"},
  {"s": "Phoenix", "r": "makes", "o": "a pile"},
  {"s": "Phoenix", "r": "lays", "o": "an egg"},
  {"s": "it", "r": "burns", "o": "itself"},
  {"s": "it", "r": "goes", "o": "to a pile of its own egg"},
  {"s": "I", "r": "ca n’t tell", "o": "you"},
  {"s": "It", "r": "turned", "o": "tail"},
  {"s": "It", "r": "presented", "o": "its golden tail to the children"},
  {"s": "Phoenix", "r": "has", "o": "an egg like all respectable birds"},
  {"s": "it", "r": "burns", "o": "itself"},
  {"s": "It", "r": "goes", "o": "to sleep and wakes up in its egg"},
  {"s": "it", "r": "lives", "o": "again for ever and ever"},
  {"s": "Anthea", "r": "asks", "o": "how the egg got HERE"}
]

==================================================

[TIME] task_16_moderate_triples_llm[drop] took 1.390s

Moderation removed 0 triples
Valid JSON
[TIME] pipeline_B took 8.677s
Checkpoint saved to ./datasets/checkpoint.pkl
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: relation_extraction -> in-progress
127.0.0.1 - - [09/Dec/2025 15:00:57] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: llm_inference -> in-progress
127.0.0.1 - - [09/Dec/2025 15:00:57] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: relation_extraction -> completed
127.0.0.1 - - [09/Dec/2025 15:00:57] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: llm_inference -> completed
127.0.0.1 - - [09/Dec/2025 15:00:57] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: graph_verbalization -> in-progress
127.0.0.1 - - [09/Dec/2025 15:00:57] "POST /status/chunk HTTP/1.1" 200 -
They say that it lives about five hundred years in the wilderness
it lives about five hundred years in the wilderness
it builds a pile of sweet wood and aromatic gums
They fire the pile
They burns itself
from its ashes arises a worm
worm grows to be a Phoenix
Phoenix has an egg
Phoenix makes a pile
Phoenix lays an egg
it burns itself
it goes to a pile of its own egg
I ca n’t tell you
It turned tail
It presented its golden tail to the children
Phoenix has an egg like all respectable birds
it burns itself
It goes to sleep and wakes up in its egg
it lives again for ever and ever
Anthea asks how the egg got HERE
[TIME] task_20_send_triples took 4.475s
[TIME] task_22_fetch_subgraph[popular] took 0.360s
[TIME] task_23_verbalize_triples[raw] took 0.001s

Triples which best represent the graph:
They SAY that_lives_about_five_hundred_years_in_wilderness
it LIVES about_five_hundred_years_in_wilderness
it BUILDS pile_of_sweet_wood_and_aromatic_gums
They FIRE pile
Phoenix MAKES pile
They BURNS itself
it BURNS itself
Phoenix HAS egg
Phoenix LAYS egg
it GOES to_pile_of_own_egg
It TURNED tail
It PRESENTED golden_tail_to_children
Phoenix HAS egg_like_respectable_birds
It GOES sleep_and_wakes_up_in_egg
it LIVES again_for_ever_and_ever
[TIME] pipeline_C took 4.922s
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: graph_verbalization -> completed
127.0.0.1 - - [09/Dec/2025 15:01:02] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Story 1: summarization -> in-progress
127.0.0.1 - - [09/Dec/2025 15:01:02] "POST /status/story HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: summarization -> in-progress
127.0.0.1 - - [09/Dec/2025 15:01:02] "POST /status/chunk HTTP/1.1" 200 -
[TIME] task_30_summarize_llm[openai] took 3.035s

Generated summary:
A phoenix is said to live for about five hundred years in the wilderness. It builds a pile of sweet wood and aromatic gums, and the pile is set on fire. The phoenix burns itself, as does another self described as “it.” The phoenix has an egg and lays eggs, and one egg is placed on its own pile. The creature’s tail is presented to children, and it eventually goes to sleep and wakes up inside the egg. Afterward, it lives again forever and ever.
[TIME] task_31_send_summary took 0.002s
    [Wrote summary to Mongo with chunk_id: story-1_book-2_chapter-6_p.74132]
[TIME] pipeline_D took 3.091s
[STATUS] Story 1: summarization -> completed
127.0.0.1 - - [09/Dec/2025 15:01:05] "POST /status/story HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: summarization -> completed
127.0.0.1 - - [09/Dec/2025 15:01:05] "POST /status/chunk HTTP/1.1" 200 -
[ASSIGNED] chunk 'story-1_book-2_chapter-6_p.74132' to worker questeval: using database 'conan_capstone' and collection 'story_chunks'
127.0.0.1 - - [09/Dec/2025 15:01:05] "POST /process_story HTTP/1.1" 200 -
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=questeval, status=started
Triggered questeval: {'assigned': 1, 'status': 'tasks_assigned', 'story_id': 1, 'task_type': 'questeval', 'total_chunks': 1}
172.18.0.2 - - [09/Dec/2025 15:01:05] "POST /callback HTTP/1.1" 200 -
[ASSIGNED] chunk 'story-1_book-2_chapter-6_p.74132' to worker bookscore: using database 'conan_capstone' and collection 'story_chunks'
127.0.0.1 - - [09/Dec/2025 15:01:05] "POST /process_story HTTP/1.1" 200 -
Triggered bookscore: {'assigned': 1, 'status': 'tasks_assigned', 'story_id': 1, 'task_type': 'bookscore', 'total_chunks': 1}

=== TIMING SUMMARY ===
                                      calls     total       avg       min       max
function
pipeline_A                                1  1.854507  1.854507  1.854507  1.854507
pipeline_B                                1  8.676950  8.676950  8.676950  8.676950
pipeline_C                                1  4.922335  4.922335  4.922335  4.922335
pipeline_D                                1  3.090865  3.090865  3.090865  3.090865
task_01_convert_epub                      1  1.745339  1.745339  1.745339  1.745339
task_02_parse_chapters                    1  0.027576  0.027576  0.027576  0.027576
task_03_chunk_story                       1  0.014655  0.014655  0.014655  0.014655
task_11_send_chunk                        1  0.025028  0.025028  0.025028  0.025028
task_12_relation_extraction[textacy]      1  1.269086  1.269086  1.269086  1.269086
task_14_validate_llm[openai]              1  5.845228  5.845228  5.845228  5.845228
task_16_moderate_triples_llm[drop]        1  1.390381  1.390381  1.390381  1.390381
task_20_send_triples                      1  4.475046  4.475046  4.475046  4.475046
task_22_fetch_subgraph[popular]           1  0.360236  0.360236  0.360236  0.360236
task_23_verbalize_triples[raw]            1  0.000755  0.000755  0.000755  0.000755
task_30_summarize_llm[openai]             1  3.034990  3.034990  3.034990  3.034990
task_31_send_summary                      1  0.001793  0.001793  0.001793  0.001793

Total execution time: 36.735s
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=bookscore, status=started
172.18.0.3 - - [09/Dec/2025 15:01:05] "POST /callback HTTP/1.1" 200 -
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
Initial processing complete. Server listening for additional requests from Blazor...
Press Ctrl+C to stop.
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=bookscore, status=completed
[TIME] worker_metric_bookscore took 12.791s
[STORY COMPLETE] All chunks completed metric_bookscore for story 1

=== TIMING SUMMARY ===
                                      calls      total        avg        min        max
function
pipeline_A                                1   1.854507   1.854507   1.854507   1.854507
pipeline_B                                1   8.676950   8.676950   8.676950   8.676950
pipeline_C                                1   4.922335   4.922335   4.922335   4.922335
pipeline_D                                1   3.090865   3.090865   3.090865   3.090865
task_01_convert_epub                      1   1.745339   1.745339   1.745339   1.745339
task_02_parse_chapters                    1   0.027576   0.027576   0.027576   0.027576
task_03_chunk_story                       1   0.014655   0.014655   0.014655   0.014655
task_11_send_chunk                        1   0.025028   0.025028   0.025028   0.025028
task_12_relation_extraction[textacy]      1   1.269086   1.269086   1.269086   1.269086
task_14_validate_llm[openai]              1   5.845228   5.845228   5.845228   5.845228
task_16_moderate_triples_llm[drop]        1   1.390381   1.390381   1.390381   1.390381
task_20_send_triples                      1   4.475046   4.475046   4.475046   4.475046
task_22_fetch_subgraph[popular]           1   0.360236   0.360236   0.360236   0.360236
task_23_verbalize_triples[raw]            1   0.000755   0.000755   0.000755   0.000755
task_30_summarize_llm[openai]             1   3.034990   3.034990   3.034990   3.034990
task_31_send_summary                      1   0.001793   0.001793   0.001793   0.001793
worker_metric_bookscore                   1  12.790528  12.790528  12.790528  12.790528

Total execution time: 49.525s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
172.18.0.3 - - [09/Dec/2025 15:01:19] "POST /callback HTTP/1.1" 200 -
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=questeval, status=completed
[TIME] worker_metric_questeval took 307.425s
[STORY COMPLETE] All chunks completed metric_questeval for story 1

=== TIMING SUMMARY ===
                                      calls       total         avg         min         max
function
pipeline_A                                1    1.854507    1.854507    1.854507    1.854507
pipeline_B                                1    8.676950    8.676950    8.676950    8.676950
pipeline_C                                1    4.922335    4.922335    4.922335    4.922335
pipeline_D                                1    3.090865    3.090865    3.090865    3.090865
task_01_convert_epub                      1    1.745339    1.745339    1.745339    1.745339
task_02_parse_chapters                    1    0.027576    0.027576    0.027576    0.027576
task_03_chunk_story                       1    0.014655    0.014655    0.014655    0.014655
task_11_send_chunk                        1    0.025028    0.025028    0.025028    0.025028
task_12_relation_extraction[textacy]      1    1.269086    1.269086    1.269086    1.269086
task_14_validate_llm[openai]              1    5.845228    5.845228    5.845228    5.845228
task_16_moderate_triples_llm[drop]        1    1.390381    1.390381    1.390381    1.390381
task_20_send_triples                      1    4.475046    4.475046    4.475046    4.475046
task_22_fetch_subgraph[popular]           1    0.360236    0.360236    0.360236    0.360236
task_23_verbalize_triples[raw]            1    0.000755    0.000755    0.000755    0.000755
task_30_summarize_llm[openai]             1    3.034990    3.034990    3.034990    3.034990
task_31_send_summary                      1    0.001793    0.001793    0.001793    0.001793
worker_metric_bookscore                   1   12.790528   12.790528   12.790528   12.790528
worker_metric_questeval                   1  307.424840  307.424840  307.424840  307.424840

Total execution time: 356.950s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
[TIME] task_45_eval_coverage took 1.037s
[TIME] task_45_eval_rouge took 3.331s
Downloading builder script: 7.95kB [00:00, 15.9MB/s]
[TIME] task_45_eval_bertscore took 14.057s
[TIME] task_45_eval_ngrams took 0.024s
[TIME] task_45_eval_jsd took 0.007s
[TIME] task_45_eval_ncd took 0.000s
[TIME] task_45_eval_salience took 0.012s
[TIME] task_45_eval_faithfulness took 29.251s
[TIME] task_45_eval_readability took 1.139s
[TIME] task_45_eval_sentence_coherence took 4.777s
[TIME] task_45_eval_entity_grid took 0.546s
[TIME] task_45_eval_diversity took 0.000s
[TIME] task_45_eval_stopwords took 0.002s
Downloading builder script: 6.14kB [00:00, 21.9MB/s]
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Sending payload to Blazor at http://blazor_service:5055/api/metrics
POST succeeded
{'bookID': '2', 'bookTitle': 'The Phoenix and the Carpet', 'summaryText': 'A phoenix is said to live for about five hundred years in the wilderness. It builds a pile of sweet wood and aromatic gums, and the pile is set on fire. The phoenix burns itself, as does another self described as “it.” The phoenix has an egg and lays eggs, and one egg is placed on its own pile. The creature’s tail is presented to children, and it eventually goes to sleep and wakes up inside the egg. Afterward, it lives again forever and ever.', 'goldSummaryText': '‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’\n‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. Tha', 'metrics': {'prF1Metrics': [{'name': 'BERTScore', 'precision': 0.8680262565612793, 'recall': 0.8321287035942078, 'f1Score': 0.8496984839439392}], 'qa': {'qaItems': [{'question': 'UNKNOWN', 'goldAnswer': 'UNKNOWN', 'generatedAnswer': 'UNKNOWN', 'isCorrect': False, 'accuracy': 0}, {'question': 'UNKNOWN', 'goldAnswer': 'UNKNOWN', 'generatedAnswer': 'UNKNOWN', 'isCorrect': False, 'accuracy': 0}], 'averageAccuracy': 0}, 'scalarMetrics': [{'name': 'BooookScore (Chang 2024)', 'value': 0.19999999999999996}, {'name': 'QuestEval (Scialom 2021)', 'value': 0.30068569446818094}, {'name': 'ROUGE-1', 'value': 0.3981481481481482}, {'name': 'ROUGE-2', 'value': 0.18691588785046728}, {'name': 'ROUGE-L', 'value': 0.23148148148148148}, {'name': 'ROUGE-Lsum', 'value': 0.2592592592592593}]}, 'qaResults': []}
[TIME] task_40_post_payload took 29.682s

Output sent to web app.
[TIME] pipeline_E took 83.882s
[PIPELINE FINALIZED] Story 1 fully processed

=== TIMING SUMMARY ===
                                      calls       total         avg         min         max
function
pipeline_A                                1    1.854507    1.854507    1.854507    1.854507
pipeline_B                                1    8.676950    8.676950    8.676950    8.676950
pipeline_C                                1    4.922335    4.922335    4.922335    4.922335
pipeline_D                                1    3.090865    3.090865    3.090865    3.090865
pipeline_E                                1   83.881873   83.881873   83.881873   83.881873
task_01_convert_epub                      1    1.745339    1.745339    1.745339    1.745339
task_02_parse_chapters                    1    0.027576    0.027576    0.027576    0.027576
task_03_chunk_story                       1    0.014655    0.014655    0.014655    0.014655
task_11_send_chunk                        1    0.025028    0.025028    0.025028    0.025028
task_12_relation_extraction[textacy]      1    1.269086    1.269086    1.269086    1.269086
task_14_validate_llm[openai]              1    5.845228    5.845228    5.845228    5.845228
task_16_moderate_triples_llm[drop]        1    1.390381    1.390381    1.390381    1.390381
task_20_send_triples                      1    4.475046    4.475046    4.475046    4.475046
task_22_fetch_subgraph[popular]           1    0.360236    0.360236    0.360236    0.360236
task_23_verbalize_triples[raw]            1    0.000755    0.000755    0.000755    0.000755
task_30_summarize_llm[openai]             1    3.034990    3.034990    3.034990    3.034990
task_31_send_summary                      1    0.001793    0.001793    0.001793    0.001793
task_40_post_payload                      1   29.681760   29.681760   29.681760   29.681760
task_45_eval_bertscore                    1   14.056831   14.056831   14.056831   14.056831
task_45_eval_coverage                     1    1.036578    1.036578    1.036578    1.036578
task_45_eval_diversity                    1    0.000468    0.000468    0.000468    0.000468
task_45_eval_entity_grid                  1    0.546148    0.546148    0.546148    0.546148
task_45_eval_faithfulness                 1   29.251400   29.251400   29.251400   29.251400
task_45_eval_jsd                          1    0.006979    0.006979    0.006979    0.006979
task_45_eval_ncd                          1    0.000204    0.000204    0.000204    0.000204
task_45_eval_ngrams                       1    0.024264    0.024264    0.024264    0.024264
task_45_eval_readability                  1    1.138949    1.138949    1.138949    1.138949
task_45_eval_rouge                        1    3.331214    3.331214    3.331214    3.331214
task_45_eval_salience                     1    0.011854    0.011854    0.011854    0.011854
task_45_eval_sentence_coherence           1    4.777321    4.777321    4.777321    4.777321
task_45_eval_stopwords                    1    0.002413    0.002413    0.002413    0.002413
worker_metric_bookscore                   1   12.790528   12.790528   12.790528   12.790528
worker_metric_questeval                   1  307.424840  307.424840  307.424840  307.424840

Total execution time: 524.698s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
[CHART] Saved chart 'Saved summary metrics CSV' to ./logs/metrics/chunk_summary.csv
172.18.0.2 - - [09/Dec/2025 15:07:38] "POST /callback HTTP/1.1" 200 -
INFO:werkzeug:172.18.0.2 - - [09/Dec/2025 15:07:38] "POST /callback HTTP/1.1" 200 -
^Cmake[2]: *** [Makefile:77: docker-start] Interrupt
make[1]: *** [Makefile:89: docker-python] Interrupt
make: *** [Makefile:137: docker-python-dev] Interrupt

conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ make docker-copy-logs
Successfully copied 95.7kB to /mnt/c/dsci-cap/capstone/./
conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ docker logs container-bscore
 * Serving Flask app 'worker'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5002
 * Running on http://172.17.0.3:5002
Press CTRL+C to quit
[QUEUED] chunk 'story-1_book-2_chapter-6_p.74132' from Boss: using database 'conan_capstone' and collection 'story_chunks'
172.18.0.8 - - [09/Dec/2025 15:01:05] "POST /tasks/queue HTTP/1.1" 202 -
FINISHED: chunk ID: story-1_book-2_chapter-6_p.74132, result:
{'value': 0.19999999999999996, 'annotations': {'A phoenix is said to live for about five hundred years in the wilderness.': {'questions': None, 'types': None}, 'It builds a pile of sweet wood and aromatic gums, and the pile is set on fire.': {'questions': 'What is the significance of the pile of sweet wood and aromatic gums? Why is it set on fire? What happens to the phoenix during this process?', 'types': ['event omission', 'causal omission']}, 'The phoenix burns itself, as does another self described as “it.” The phoenix has an egg and lays eggs, and one egg is placed on its own pile.': {'questions': 'What does "another self described as \'it\'" refer to? How does the egg relate to the phoenix\'s lifecycle? What is the significance of the egg being placed on its own pile?', 'types': ['entity omission', 'event omission', 'causal omission']}, 'The creature’s tail is presented to children, and it eventually goes to sleep and wakes up inside the egg.': {'questions': "Why is the creature's tail presented to children? What is the significance of the creature going to sleep and waking up inside the egg?", 'types': ['entity omission', 'causal omission']}, 'Afterward, it lives again forever and ever.': {'questions': 'What does "it" refer to? Is "it" the phoenix or another entity? How does the phoenix live again after waking up inside the egg?', 'types': ['entity omission', 'event omission']}}, 'model_used': 'openai-model_gpt-4o-mini'}
conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ docker logs container-qeval
Downloading: 6.81kB [00:00, 9.50MB/s]
WARNING:root:Downloading language model for the spaCy model.
DEPRECATION: https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.0.0/en_core_web_sm-3.0.0-py3-none-any.whl#egg=en_core_web_sm==3.0.0 contains an egg fragment with a non-PEP 508 name. pip 25.1 will enforce this behaviour change. A possible replacement is to use the req @ url syntax, and remove the egg fragment. Discussion can be found at https://github.com/pypa/pip/issues/13157
Collecting en-core-web-sm==3.0.0
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.0.0/en_core_web_sm-3.0.0-py3-none-any.whl (13.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.7/13.7 MB 25.9 MB/s eta 0:00:00
Requirement already satisfied: spacy<3.1.0,>=3.0.0 in /usr/local/lib/python3.8/site-packages (from en-core-web-sm==3.0.0) (3.0.6)
Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.4 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.0.12)
Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.0.13)
Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.0.11)
Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.0.10)
Requirement already satisfied: thinc<8.1.0,>=8.0.3 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (8.0.17)
Requirement already satisfied: blis<0.8.0,>=0.4.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.7.11)
Requirement already satisfied: wasabi<1.1.0,>=0.8.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.10.1)
Requirement already satisfied: srsly<3.0.0,>=2.4.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.4.8)
Requirement already satisfied: catalogue<2.1.0,>=2.0.3 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.0.10)
Requirement already satisfied: typer<0.4.0,>=0.3.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.3.2)
Requirement already satisfied: pathy>=0.3.5 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.11.0)
Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (4.49.0)
Requirement already satisfied: numpy>=1.15.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.24.4)
Requirement already satisfied: requests<3.0.0,>=2.13.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.32.4)
Requirement already satisfied: pydantic<1.8.0,>=1.7.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.7.4)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.11.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (75.3.2)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (25.0)
Requirement already satisfied: smart-open<7.0.0,>=5.2.1 in /usr/local/lib/python3.8/site-packages (from pathy>=0.3.5->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (6.4.0)
Requirement already satisfied: pathlib-abc==0.1.1 in /usr/local/lib/python3.8/site-packages (from pathy>=0.3.5->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.1.1)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.2.3)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2025.10.5)
Requirement already satisfied: click<7.2.0,>=7.1.1 in /usr/local/lib/python3.8/site-packages (from typer<0.4.0,>=0.3.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (7.1.2)
Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.8/site-packages (from jinja2->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.1.1)
Installing collected packages: en-core-web-sm
Successfully installed en-core-web-sm-3.0.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
✔ Download and installation successful
You can now load the package via spacy.load('en_core_web_sm')







 * Serving Flask app "worker" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
INFO:werkzeug: * Running on http://0.0.0.0:5001/ (Press CTRL+C to quit)
[QUEUED] chunk 'story-1_book-2_chapter-6_p.74132' from Boss: using database 'conan_capstone' and collection 'story_chunks'
INFO:werkzeug:172.18.0.8 - - [09/Dec/2025 15:01:05] "POST /tasks/queue HTTP/1.1" 202 -
Some weights of the model checkpoint at /root/.cache/huggingface/transformers/bert-base-multilingual-cased were not used when initializing BertModel: ['cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
FINISHED: chunk ID: story-1_book-2_chapter-6_p.74132, result:
{'value': 0.30068569446818094, 'has_reference': False}
Failed to notify boss: HTTPConnectionPool(host='python_service', port=5054): Read timed out. (read timeout=5)