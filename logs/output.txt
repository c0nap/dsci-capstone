conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ make docker-python-dev
[+] Building 3.2s (22/22) FINISHED                                                                       docker:default
 => [internal] load build definition from python.dockerfile                                                        0.0s
 => => transferring dockerfile: 1.54kB                                                                             0.0s
 => [internal] load metadata for docker.io/library/python:3.12-slim                                                0.4s
 => [internal] load .dockerignore                                                                                  0.1s
 => => transferring context: 79B                                                                                   0.0s
 => [internal] load build context                                                                                  0.6s
 => => transferring context: 28.99kB                                                                               0.6s
 => [ 1/17] FROM docker.io/library/python:3.12-slim@sha256:590cad70271b6c1795c6a11fb5c110efca593adbd0d4883cd19c36  0.0s
 => CACHED [ 2/17] WORKDIR /pipeline                                                                               0.0s
 => CACHED [ 3/17] RUN apt-get update && apt-get install -y --no-install-recommends     build-essential     make   0.0s
 => CACHED [ 4/17] COPY deps/requirements.txt .                                                                    0.0s
 => CACHED [ 5/17] RUN pip install --no-cache-dir -r requirements.txt                                              0.0s
 => CACHED [ 6/17] RUN python -m spacy download en_core_web_sm                                                     0.0s
 => CACHED [ 7/17] RUN python -m nltk.downloader punkt punkt_tab stopwords                                         0.0s
 => [ 8/17] COPY src/ src/                                                                                         0.1s
 => [ 9/17] COPY tests/ tests/                                                                                     0.1s
 => [10/17] COPY smoke/ smoke/                                                                                     0.0s
 => [11/17] COPY datasets/ datasets/                                                                               0.0s
 => [12/17] COPY .env .env                                                                                         0.0s
 => [13/17] COPY Makefile .                                                                                        0.0s
 => [14/17] RUN make env-docker                                                                                    0.5s
 => [15/17] RUN mv .env.docker .env                                                                                0.3s
 => [16/17] COPY pyproject.toml pytest.ini conftest.py .                                                           0.1s
 => [17/17] COPY logs/elapsed_time.csv logs/                                                                       0.0s
 => exporting to image                                                                                             0.3s
 => => exporting layers                                                                                            0.2s
 => => writing image sha256:4321092cbb723b022ef6af17109a7d64878ea170e99a302663711d395329bba3                       0.0s
 => => naming to docker.io/library/dsci-cap-img-python-dev:latest                                                  0.0s
container-python
0c8f6f9be001bbc07da06c743f6e73d78feac29c392aef21299ff43589def289
Network 'capstone_default' already exists; continue...
Deleted old chunks...
 * Serving Flask app 'src.core.boss'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5054
 * Running on http://172.17.0.5:5054
Press CTRL+C to quit
[STATUS] Story 1: preprocessing -> in-progress
127.0.0.1 - - [09/Dec/2025 20:17:01] "POST /status/story HTTP/1.1" 200 -
127.0.0.1 - - [09/Dec/2025 20:17:01] "POST /status/story HTTP/1.1" 200 -
[STATUS] Story 1: chunking -> in-progress

==================================================
Processing: ./tests/examples-pipeline/epub/trilogy-wishes-2.epub
[TIME] task_01_convert_epub took 1.684s
[TIME] task_02_parse_chapters took 0.026s
[TIME] task_03_chunk_story took 0.014s

=== STORY SUMMARY ===
Total chunks: 254
[TIME] pipeline_A took 1.791s
[STATUS] Story 1: preprocessing -> completed
127.0.0.1 - - [09/Dec/2025 20:17:03] "POST /status/story HTTP/1.1" 200 -
[STATUS] Story 1: chunking -> completed
127.0.0.1 - - [09/Dec/2025 20:17:03] "POST /status/story HTTP/1.1" 200 -

Chunk details:
  index: 18

‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’
‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. That book ought to be destroyed. It’s most inaccurate. The rest of my body was never purple, and as for my—tail—well, I simply ask you, IS it white?’
It turned round and gravely presented its golden tail to the children.
‘No, it’s not,’ said everybody.
‘No, and it never was,’ said the Phoenix. ‘And that about the worm is just a vulgar insult. The Phoenix has an egg, like all respectable birds. It makes a pile—that part’s all right—and it lays its egg, and it burns itself; and it goes to sleep and wakes up in its egg, and comes out and goes on living again, and so on for ever and ever. I can’t tell you how weary I got of it—such a restless existence; no repose.’
‘But how did your egg get HERE?’ asked Anthea.
[TIME] task_11_send_chunk took 0.021s
    [Inserted chunk into Mongo with chunk_id: story-1_book-2_chapter-6_p.74132]
2025-12-09 20:17:03 INFO: Installing CoreNLP package into /root/stanza_corenlp
Ensuring CoreNLP backend is installed...
Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   0%|          | 0.00/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   0%|          | 1.84M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   1%|          | 4.72M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   2%|▏         | 8.78M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   2%|▏         | 11.9M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   3%|▎         | 15.6M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   4%|▎         | 19.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   4%|▍         | 22.7M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   5%|▌         | 26.7M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   6%|▌         | 31.1M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   7%|▋         | 35.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   8%|▊         | 38.5M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   8%|▊         | 42.3M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:   9%|▉         | 45.9M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  10%|▉         | 49.3M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  10%|█         | 52.7M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  11%|█         | 56.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  12%|█▏        | 59.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  12%|█▏        | 62.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  13%|█▎        | 64.9M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  13%|█▎        | 67.5M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  14%|█▍        | 70.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  14%|█▍        | 72.5M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  15%|█▍        | 75.1M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  15%|█▌        | 78.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  16%|█▌        | 80.6M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  16%|█▋        | 83.6M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  17%|█▋        | 86.2M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  18%|█▊        | 89.1M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  18%|█▊        | 92.1M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  19%|█▊        | 95.0M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  19%|█▉        | 97.9M/Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  20%|█▉        | 101M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  20%|██        | 103M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  21%|██        | 106M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  21%|██▏       | 109M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  22%|██▏       | 112M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  23%|██▎       | 114M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  23%|██▎       | 118M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  24%|██▍       | 121M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  24%|██▍       | 124M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  25%|██▌       | 128M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  26%|██▌       | 131M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  26%|██▋       | 134M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  27%|██▋       | 138M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  28%|██▊       | 141M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  28%|██▊       | 144M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  29%|██▉       | 147M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  29%|██▉       | 150M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  30%|███       | 153M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  31%|███       | 157M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  32%|███▏      | 161M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  33%|███▎      | 166M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  33%|███▎      | 169M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  34%|███▍      | 173M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  35%|███▍      | 177M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  35%|███▌      | 180M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  36%|███▌      | 184M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  37%|███▋      | 187M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  38%|███▊      | 194M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  39%|███▉      | 198M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  40%|███▉      | 202M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  41%|████      | 206M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  41%|████▏     | 210M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  42%|████▏     | 215M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  43%|████▎     | 219M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  44%|████▍     | 224M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  45%|████▌     | 229M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  46%|████▌     | 234M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  47%|████▋     | 239M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  48%|████▊     | 243M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  49%|████▊     | 248M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  50%|████▉     | 253M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  51%|█████     | 258M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  52%|█████▏    | 262M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  52%|█████▏    | 266M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  53%|█████▎    | 271M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  54%|█████▍    | 277M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  56%|█████▌    | 284M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  57%|█████▋    | 289M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  58%|█████▊    | 294M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  59%|█████▊    | 298M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  60%|█████▉    | 303M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  61%|██████    | 308M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  61%|██████▏   | 312M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  62%|██████▏   | 316M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  63%|██████▎   | 320M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  64%|██████▍   | 326M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  66%|██████▌   | 334M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  67%|██████▋   | 338M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  68%|██████▊   | 344M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  68%|██████▊   | 348M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  69%|██████▉   | 353M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  70%|███████   | 357M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  71%|███████   | 361M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  72%|███████▏  | 366M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  73%|███████▎  | 369M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  73%|███████▎  | 373M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  74%|███████▍  | 377M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  75%|███████▍  | 381M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  76%|███████▌  | 384M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  76%|███████▌  | 387M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  77%|███████▋  | 391M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  78%|███████▊  | 395M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  78%|███████▊  | 398M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  79%|███████▉  | 401M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  80%|███████▉  | 405M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  80%|████████  | 408M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  81%|████████  | 411M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  81%|████████▏ | 414M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  82%|████████▏ | 416M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  82%|████████▏ | 419M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  83%|████████▎ | 422M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  84%|████████▎ | 425M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  84%|████████▍ | 428M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  85%|████████▍ | 431M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  85%|████████▌ | 434M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  86%|████████▌ | 437M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  86%|████████▋ | 439M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  87%|████████▋ | 443M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  88%|████████▊ | 446M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  88%|████████▊ | 449M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  89%|████████▉ | 453M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  90%|████████▉ | 456M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  90%|█████████ | 459M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  91%|█████████ | 462M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  91%|█████████▏| 465M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  92%|█████████▏| 469M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  93%|█████████▎| 472M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  93%|█████████▎| 475M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  94%|█████████▍| 479M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  95%|█████████▌| 483M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  96%|█████████▌| 487M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  97%|█████████▋| 491M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  97%|█████████▋| 495M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  98%|█████████▊| 499M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip:  99%|█████████▉| 503M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip: 100%|█████████▉| 507M/5Downloading https://huggingface.co/stanfordnlp/CoreNLP/resolve/main/stanford-corenlp-latest.zip: 100%|██████████| 508M/508M [00:15<00:00, 32.4MB/s]
2025-12-09 20:17:19 INFO: Downloaded file to /root/stanza_corenlp/corenlp.zip
2025-12-09 20:17:21 INFO: Writing properties to tmp file: corenlp_server-c0c2e00069db432e.props
2025-12-09 20:17:21 INFO: Starting server with command: java -Xmx4G -cp /root/stanza_corenlp/* edu.stanford.nlp.pipeline.StanfordCoreNLPServer -port 9000 -timeout 120000 -threads 5 -maxCharLength 100000 -quiet True -serverProperties corenlp_server-c0c2e00069db432e.props -annotators tokenize,ssplit,pos,lemma,ner,parse,coref,openie -preload -outputFormat serialized
[TIME] task_12_relation_extraction[openie] took 49.374s

NLP output:
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'beautiful plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'finely crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'eyes', 'r': 'sparkling like', 'o': 'stars'}
{'s': 'size', 'r': 'crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck'}
{'s': 'size', 'r': 'finely crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'it', 'r': 'builds with', 'o': 'the wafting of it wings'}
{'s': 'it', 'r': 'pile of', 'o': 'wood'}
{'s': 'about five hundred years', 'r': 'is in', 'o': 'wilderness'}
{'s': 'it', 'r': 'pile of', 'o': 'sweet wood'}
{'s': 'it', 'r': 'builds with', 'o': 'the of it wings'}
{'s': 'that', 'r': 'arises', 'o': 'worm'}
{'s': 'They', 'r': 'thus burns', 'o': 'it'}
{'s': 'it', 'r': 'advanced in', 'o': 'age'}
{'s': 'it', 'r': 'builds with', 'o': 'the'}
{'s': 'it', 'r': 'builds with', 'o': 'the wafting'}
{'s': 'They', 'r': 'burns', 'o': 'it'}
{'s': 'Phoenicians', 'r': 'were', 'o': 'people'}
{'s': 'Phoenicians', 'r': 'were', 'o': 'always people'}
{'s': 'rest of my body', 'r': 'IS', 'o': 'white'}
{'s': 'my', 'r': 'simply ask', 'o': 'you'}
{'s': 'The rest of my body', 'r': 'IS', 'o': 'white'}
{'s': 'my', 'r': 'ask', 'o': 'you'}
{'s': 'my', 'r': 'well simply ask', 'o': 'you'}
{'s': 'my', 'r': 'well ask', 'o': 'you'}
{'s': 'rest of my body', 'r': 'presented', 'o': 'rest of my body tail'}
{'s': 'rest of my body', 'r': 'gravely presented', 'o': 'rest of my body golden tail'}
{'s': 'The rest of my body', 'r': 'gravely presented', 'o': 'The rest of my body golden tail'}
{'s': 'rest of my body', 'r': 'presented', 'o': 'rest of my body golden tail'}
{'s': 'rest of my body', 'r': 'gravely presented', 'o': 'rest of my body tail'}
{'s': 'No', 'r': 'said', 'o': 'everybody'}
{'s': '’', 'r': 'said', 'o': 'Phoenix'}
{'s': 'worm', 'r': 'is', 'o': 'vulgar'}
{'s': 'worm', 'r': 'is', 'o': 'insult'}
{'s': 'worm', 'r': 'is', 'o': 'just vulgar insult'}
{'s': 'worm', 'r': 'is', 'o': 'just insult'}
{'s': 'worm', 'r': 'is', 'o': 'vulgar insult'}
{'s': 'Phoenix', 'r': 'has egg like', 'o': 'respectable birds'}
{'s': 'Phoenix', 'r': 'has', 'o': 'egg'}
{'s': 'a Phoenix', 'r': 'lays', 'o': 'a Phoenix egg'}
{'s': 'a Phoenix', 'r': 'goes to', 'o': 'sleep'}
{'s': 'Phoenix', 'r': 'burns', 'o': 'Phoenix'}
{'s': 'a Phoenix', 'r': 'wakes up in', 'o': 'a Phoenix egg'}
{'s': 'Phoenix', 'r': 'goes to', 'o': 'sleep'}
{'s': 'Phoenix', 'r': 'wakes up in', 'o': 'Phoenix egg'}
{'s': 'Phoenix', 'r': 'makes', 'o': 'pile'}
{'s': 'Phoenix', 'r': 'lays', 'o': 'Phoenix egg'}
{'s': 'a Phoenix', 'r': 'burns', 'o': 'a Phoenix'}

[TIME] task_14_validate_llm[langchain] took 177.898s

    LLM prompt:
Here are some semantic triples extracted from a story chunk:
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'beautiful plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'finely crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'eyes', 'r': 'sparkling like', 'o': 'stars'}
{'s': 'size', 'r': 'crested with', 'o': 'beautiful plumage'}
{'s': 'size', 'r': 'crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck'}
{'s': 'size', 'r': 'finely crested with', 'o': 'plumage'}
{'s': 'Cyril head', 'r': 'finely crested with', 'o': 'Cyril neck covered with feathers'}
{'s': 'size', 'r': 'finely crested with', 'o': 'Cyril neck covered'}
{'s': 'size', 'r': 'crested with', 'o': 'Cyril neck covered with feathers of gold colour'}
{'s': 'it', 'r': 'builds with', 'o': 'the wafting of it wings'}
{'s': 'it', 'r': 'pile of', 'o': 'wood'}
{'s': 'about five hundred years', 'r': 'is in', 'o': 'wilderness'}
{'s': 'it', 'r': 'pile of', 'o': 'sweet wood'}
{'s': 'it', 'r': 'builds with', 'o': 'the of it wings'}
{'s': 'that', 'r': 'arises', 'o': 'worm'}
{'s': 'They', 'r': 'thus burns', 'o': 'it'}
{'s': 'it', 'r': 'advanced in', 'o': 'age'}
{'s': 'it', 'r': 'builds with', 'o': 'the'}
{'s': 'it', 'r': 'builds with', 'o': 'the wafting'}
{'s': 'They', 'r': 'burns', 'o': 'it'}
{'s': 'Phoenicians', 'r': 'were', 'o': 'people'}
{'s': 'Phoenicians', 'r': 'were', 'o': 'always people'}
{'s': 'rest of my body', 'r': 'IS', 'o': 'white'}
{'s': 'my', 'r': 'simply ask', 'o': 'you'}
{'s': 'The rest of my body', 'r': 'IS', 'o': 'white'}
{'s': 'my', 'r': 'ask', 'o': 'you'}
{'s': 'my', 'r': 'well simply ask', 'o': 'you'}
{'s': 'my', 'r': 'well ask', 'o': 'you'}
{'s': 'rest of my body', 'r': 'presented', 'o': 'rest of my body tail'}
{'s': 'rest of my body', 'r': 'gravely presented', 'o': 'rest of my body golden tail'}
{'s': 'The rest of my body', 'r': 'gravely presented', 'o': 'The rest of my body golden tail'}
{'s': 'rest of my body', 'r': 'presented', 'o': 'rest of my body golden tail'}
{'s': 'rest of my body', 'r': 'gravely presented', 'o': 'rest of my body tail'}
{'s': 'No', 'r': 'said', 'o': 'everybody'}
{'s': '’', 'r': 'said', 'o': 'Phoenix'}
{'s': 'worm', 'r': 'is', 'o': 'vulgar'}
{'s': 'worm', 'r': 'is', 'o': 'insult'}
{'s': 'worm', 'r': 'is', 'o': 'just vulgar insult'}
{'s': 'worm', 'r': 'is', 'o': 'just insult'}
{'s': 'worm', 'r': 'is', 'o': 'vulgar insult'}
{'s': 'Phoenix', 'r': 'has egg like', 'o': 'respectable birds'}
{'s': 'Phoenix', 'r': 'has', 'o': 'egg'}
{'s': 'a Phoenix', 'r': 'lays', 'o': 'a Phoenix egg'}
{'s': 'a Phoenix', 'r': 'goes to', 'o': 'sleep'}
{'s': 'Phoenix', 'r': 'burns', 'o': 'Phoenix'}
{'s': 'a Phoenix', 'r': 'wakes up in', 'o': 'a Phoenix egg'}
{'s': 'Phoenix', 'r': 'goes to', 'o': 'sleep'}
{'s': 'Phoenix', 'r': 'wakes up in', 'o': 'Phoenix egg'}
{'s': 'Phoenix', 'r': 'makes', 'o': 'pile'}
{'s': 'Phoenix', 'r': 'lays', 'o': 'Phoenix egg'}
{'s': 'a Phoenix', 'r': 'burns', 'o': 'a Phoenix'}

And here is the original text:
‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’
‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. That book ought to be destroyed. It’s most inaccurate. The rest of my body was never purple, and as for my—tail—well, I simply ask you, IS it white?’
It turned round and gravely presented its golden tail to the children.
‘No, it’s not,’ said everybody.
‘No, and it never was,’ said the Phoenix. ‘And that about the worm is just a vulgar insult. The Phoenix has an egg, like all respectable birds. It makes a pile—that part’s all right—and it lays its egg, and it burns itself; and it goes to sleep and wakes up in its egg, and comes out and goes on living again, and so on for ever and ever. I can’t tell you how weary I got of it—such a restless existence; no repose.’
‘But how did your egg get HERE?’ asked Anthea.

Output JSON with keys: s (subject), r (relation), o (object).
Remove nonsensical triples but otherwise retain all relevant entries, and add new ones to encapsulate events, dialogue, and core meaning where applicable.

    LLM output:
[
  {"s":"Cyril","r":"describes","o":"the Phoenix is the size of an eagle"},
  {"s":"Cyril","r":"describes","o":"the Phoenix's head is finely crested with beautiful plumage"},
  {"s":"Cyril","r":"describes","o":"the Phoenix's neck is covered with feathers of a gold colour"},
  {"s":"Cyril","r":"describes","o":"the rest of its body is purple"},
  {"s":"Cyril","r":"describes","o":"the tail is white"},
  {"s":"Cyril","r":"says","o":"the Phoenix lives about five hundred years in the wilderness"},
  {"s":"Cyril","r":"says","o":"when advanced in age it builds a pile of sweet wood and aromatic gums"},
  {"s":"Cyril","r":"says","o":"it burns itself"},
  {"s":"Cyril","r":"says","o":"from its ashes arises a worm that grows to be a Phoenix"},
  {"s":"Cyril","r":"says","o":"Hence the Phoenicians gave— (interrupted)"},
  {"s":"Phoenix","r":"interrupts","o":"Cyril"},
  {"s":"Phoenix","r":"ruffles","o":"golden feathers"},
  {"s":"Phoenix","r":"says","o":"never mind what the Phoenicians gave"},
  {"s":"Phoenix","r":"says","o":"the Phoenicians gave nothing for nothing"},
  {"s":"Phoenix","r":"says","o":"that book is most inaccurate and ought to be destroyed"},
  {"s":"Phoenix","r":"denies","o":"the rest of its body was ever purple"},
  {"s":"Phoenix","r":"asks","o":"if its tail is white"},
  {"s":"Phoenix","r":"presents","o":"its golden tail to the children"},
  {"s":"Everybody","r":"answers","o":"No"},
  {"s":"Phoenix","r":"affirms","o":"its tail is not white and never was"},
  {"s":"Phoenix","r":"says","o":"the worm-from-the-ashes story is a vulgar insult"},
  {"s":"Phoenix","r":"asserts","o":"the Phoenix has an egg like all respectable birds"},
  {"s":"Phoenix","r":"asserts","o":"it makes a pile of sweet wood and aromatic gums"},
  {"s":"Phoenix","r":"asserts","o":"it lays its egg"},
  {"s":"Phoenix","r":"asserts","o":"it burns itself"},
  {"s":"Phoenix","r":"asserts","o":"it goes to sleep and wakes up in its egg"},
  {"s":"Phoenix","r":"asserts","o":"it comes out and goes on living again"},
  {"s":"Phoenix","r":"asserts","o":"this cycle continues for ever and ever"},
  {"s":"Phoenix","r":"admits","o":"weariness of such a restless existence with no repose"},
  {"s":"Anthea","r":"asks","o":"how did your egg get here?"},
  {"s":"Phoenix eyes","r":"sparkle like","o":"stars"},
  {"s":"Phoenix tail","r":"color","o":"golden"},
  {"s":"Phoenix","r":"fires the pile with","o":"the wafting of its wings"}
]

==================================================

[TIME] task_16_moderate_triples_llm[resolve] took 2.274s

Moderation removed 0 triples
Valid JSON
[TIME] pipeline_B took 229.728s
Checkpoint saved to ./datasets/checkpoint.pkl
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: relation_extraction -> in-progress
127.0.0.1 - - [09/Dec/2025 20:20:52] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: llm_inference -> in-progress
127.0.0.1 - - [09/Dec/2025 20:20:52] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: relation_extraction -> completed
127.0.0.1 - - [09/Dec/2025 20:20:52] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: llm_inference -> completed
127.0.0.1 - - [09/Dec/2025 20:20:52] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: graph_verbalization -> in-progress
127.0.0.1 - - [09/Dec/2025 20:20:52] "POST /status/chunk HTTP/1.1" 200 -
Cyril describes the Phoenix is the size of an eagle
Cyril describes the Phoenix's head is finely crested with beautiful plumage
Cyril describes the Phoenix's neck is covered with feathers of a gold colour
Cyril describes the rest of its body is purple
Cyril describes the tail is white
Cyril says the Phoenix lives about five hundred years in the wilderness
Cyril says when advanced in age it builds a pile of sweet wood and aromatic gums
Cyril says it burns itself
Cyril says from its ashes arises a worm that grows to be a Phoenix
Cyril says Hence the Phoenicians gave— (interrupted)
Phoenix interrupts Cyril
Phoenix ruffles golden feathers
Phoenix says never mind what the Phoenicians gave
Phoenix says the Phoenicians gave nothing for nothing
Phoenix says that book is most inaccurate and ought to be destroyed
Phoenix denies the rest of its body was ever purple
Phoenix asks if its tail is white
Phoenix presents its golden tail to the children
Everybody answers No
Phoenix affirms its tail is not white and never was
Phoenix says the worm-from-the-ashes story is a vulgar insult
Phoenix asserts the Phoenix has an egg like all respectable birds
Phoenix asserts it makes a pile of sweet wood and aromatic gums
Phoenix asserts it lays its egg
Phoenix asserts it burns itself
Phoenix asserts it goes to sleep and wakes up in its egg
Phoenix asserts it comes out and goes on living again
Phoenix asserts this cycle continues for ever and ever
Phoenix admits weariness of such a restless existence with no repose
Anthea asks how did your egg get here?
Phoenix eyes sparkle like stars
Phoenix tail color golden
Phoenix fires the pile with the wafting of its wings
[TIME] task_20_send_triples took 6.605s
[TIME] task_22_fetch_subgraph[community] took 3.283s
[TIME] task_23_verbalize_triples[context] took 0.001s

Triples which best represent the graph:
Facts about Phoenix:
  - ruffles golden_feathers
  - says never_mind_Phoenicians_gave
  - says Phoenicians_gave_for
  - says book_is_most_inaccurate_and_ought_be_destroyed
  - denies rest_of_body_was_ever_purple
  - asks if_tail_is_white
  - presents golden_tail_to_children
  - affirms tail_is_white_and_never_was
  - says worm_from_ashes_story_is_vulgar_insult
  - asserts Phoenix_has_egg_like_respectable_birds
  - asserts makes_pile_of_sweet_wood_and_aromatic_gums
  - asserts lays_egg
  - asserts goes_to_sleep_and_wakes_up_in_egg
  - asserts comes_out_and_goes_on_living_again
  - asserts cycle_continues_for_ever_and_ever
  - admits weariness_of_restless_existence_with_repose
  - fires the pile with wafting_of_wings
[TIME] pipeline_C took 9.971s
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: graph_verbalization -> completed
127.0.0.1 - - [09/Dec/2025 20:21:02] "POST /status/chunk HTTP/1.1" 200 -
[STATUS] Story 1: summarization -> in-progress
127.0.0.1 - - [09/Dec/2025 20:21:02] "POST /status/story HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: summarization -> in-progress
127.0.0.1 - - [09/Dec/2025 20:21:02] "POST /status/chunk HTTP/1.1" 200 -
[TIME] task_30_summarize_llm[langchain] took 43.865s

Generated summary:
The Phoenix, ruffling its golden feathers, denounces an inaccurate book about it and calls for its destruction. It rejects the purple-body and “worm-from-the-ashes” myths, shows its tail to children as proof, and explains the true cycle: like other respectable birds, it builds a pile of sweet woods and aromatic gums, kindles it by wafting its wings, lays an egg, goes to sleep, then wakes inside the egg, emerges renewed, and repeats this forever. At times it admits weariness and a longing for repose.
[TIME] task_31_send_summary took 0.001s
    [Wrote summary to Mongo with chunk_id: story-1_book-2_chapter-6_p.74132]
[TIME] pipeline_D took 43.923s
[STATUS] Story 1: summarization -> completed
127.0.0.1 - - [09/Dec/2025 20:21:46] "POST /status/story HTTP/1.1" 200 -
[STATUS] Chunk story-1_book-2_chapter-6_p.74132: summarization -> completed
127.0.0.1 - - [09/Dec/2025 20:21:46] "POST /status/chunk HTTP/1.1" 200 -
[ASSIGNED] chunk 'story-1_book-2_chapter-6_p.74132' to worker questeval: using database 'conan_capstone' and collection 'story_chunks'
127.0.0.1 - - [09/Dec/2025 20:21:46] "POST /process_story HTTP/1.1" 200 -
Triggered questeval: {'assigned': 1, 'status': 'tasks_assigned', 'story_id': 1, 'task_type': 'questeval', 'total_chunks': 1}
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=questeval, status=started
172.18.0.2 - - [09/Dec/2025 20:21:46] "POST /callback HTTP/1.1" 200 -
[ASSIGNED] chunk 'story-1_book-2_chapter-6_p.74132' to worker bookscore: using database 'conan_capstone' and collection 'story_chunks'
127.0.0.1 - - [09/Dec/2025 20:21:47] "POST /process_story HTTP/1.1" 200 -
Triggered bookscore: {'assigned': 1, 'status': 'tasks_assigned', 'story_id': 1, 'task_type': 'bookscore', 'total_chunks': 1}

=== TIMING SUMMARY ===
                                       calls       total         avg         min         max
function
pipeline_A                                 1    1.790504    1.790504    1.790504    1.790504
pipeline_B                                 1  229.727506  229.727506  229.727506  229.727506
pipeline_C                                 1    9.971251    9.971251    9.971251    9.971251
pipeline_D                                 1   43.923090   43.923090   43.923090   43.923090
task_01_convert_epub                       1    1.684466    1.684466    1.684466    1.684466
task_02_parse_chapters                     1    0.025949    0.025949    0.025949    0.025949
task_03_chunk_story                        1    0.013713    0.013713    0.013713    0.013713
task_11_send_chunk                         1    0.021415    0.021415    0.021415    0.021415
task_12_relation_extraction[openie]        1   49.373930   49.373930   49.373930   49.373930
task_14_validate_llm[langchain]            1  177.897707  177.897707  177.897707  177.897707
task_16_moderate_triples_llm[resolve]      1    2.273544    2.273544    2.273544    2.273544
task_20_send_triples                       1    6.605025    6.605025    6.605025    6.605025
task_22_fetch_subgraph[community]          1    3.283399    3.283399    3.283399    3.283399
task_23_verbalize_triples[context]         1    0.001375    0.001375    0.001375    0.001375
task_30_summarize_llm[langchain]           1   43.865026   43.865026   43.865026   43.865026
task_31_send_summary                       1    0.001491    0.001491    0.001491    0.001491

Total execution time: 570.459s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=bookscore, status=started
172.18.0.3 - - [09/Dec/2025 20:21:47] "POST /callback HTTP/1.1" 200 -
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
Initial processing complete. Server listening for additional requests from Blazor...
Press Ctrl+C to stop.
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=bookscore, status=completed
[TIME] worker_metric_bookscore took 6.609s
[STORY COMPLETE] All chunks completed metric_bookscore for story 1

=== TIMING SUMMARY ===
                                       calls       total         avg         min         max
function
pipeline_A                                 1    1.790504    1.790504    1.790504    1.790504
pipeline_B                                 1  229.727506  229.727506  229.727506  229.727506
pipeline_C                                 1    9.971251    9.971251    9.971251    9.971251
pipeline_D                                 1   43.923090   43.923090   43.923090   43.923090
task_01_convert_epub                       1    1.684466    1.684466    1.684466    1.684466
task_02_parse_chapters                     1    0.025949    0.025949    0.025949    0.025949
task_03_chunk_story                        1    0.013713    0.013713    0.013713    0.013713
task_11_send_chunk                         1    0.021415    0.021415    0.021415    0.021415
task_12_relation_extraction[openie]        1   49.373930   49.373930   49.373930   49.373930
task_14_validate_llm[langchain]            1  177.897707  177.897707  177.897707  177.897707
task_16_moderate_triples_llm[resolve]      1    2.273544    2.273544    2.273544    2.273544
task_20_send_triples                       1    6.605025    6.605025    6.605025    6.605025
task_22_fetch_subgraph[community]          1    3.283399    3.283399    3.283399    3.283399
task_23_verbalize_triples[context]         1    0.001375    0.001375    0.001375    0.001375
task_30_summarize_llm[langchain]           1   43.865026   43.865026   43.865026   43.865026
task_31_send_summary                       1    0.001491    0.001491    0.001491    0.001491
worker_metric_bookscore                    1    6.608875    6.608875    6.608875    6.608875

Total execution time: 577.068s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
172.18.0.3 - - [09/Dec/2025 20:21:54] "POST /callback HTTP/1.1" 200 -
[CALLBACK] chunk_id=story-1_book-2_chapter-6_p.74132, task=questeval, status=completed
[TIME] worker_metric_questeval took 315.021s
[STORY COMPLETE] All chunks completed metric_questeval for story 1

=== TIMING SUMMARY ===
                                       calls       total         avg         min         max
function
pipeline_A                                 1    1.790504    1.790504    1.790504    1.790504
pipeline_B                                 1  229.727506  229.727506  229.727506  229.727506
pipeline_C                                 1    9.971251    9.971251    9.971251    9.971251
pipeline_D                                 1   43.923090   43.923090   43.923090   43.923090
task_01_convert_epub                       1    1.684466    1.684466    1.684466    1.684466
task_02_parse_chapters                     1    0.025949    0.025949    0.025949    0.025949
task_03_chunk_story                        1    0.013713    0.013713    0.013713    0.013713
task_11_send_chunk                         1    0.021415    0.021415    0.021415    0.021415
task_12_relation_extraction[openie]        1   49.373930   49.373930   49.373930   49.373930
task_14_validate_llm[langchain]            1  177.897707  177.897707  177.897707  177.897707
task_16_moderate_triples_llm[resolve]      1    2.273544    2.273544    2.273544    2.273544
task_20_send_triples                       1    6.605025    6.605025    6.605025    6.605025
task_22_fetch_subgraph[community]          1    3.283399    3.283399    3.283399    3.283399
task_23_verbalize_triples[context]         1    0.001375    0.001375    0.001375    0.001375
task_30_summarize_llm[langchain]           1   43.865026   43.865026   43.865026   43.865026
task_31_send_summary                       1    0.001491    0.001491    0.001491    0.001491
worker_metric_bookscore                    1    6.608875    6.608875    6.608875    6.608875
worker_metric_questeval                    1  315.021475  315.021475  315.021475  315.021475

Total execution time: 892.090s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
[TIME] task_45_eval_coverage took 0.622s
[TIME] task_45_eval_rouge took 2.900s
Downloading builder script: 7.95kB [00:00, 24.8MB/s]
[TIME] task_45_eval_bertscore took 15.546s
[TIME] task_45_eval_ngrams took 0.024s
[TIME] task_45_eval_jsd took 0.009s
[TIME] task_45_eval_ncd took 0.000s
[TIME] task_45_eval_salience took 0.011s
[TIME] task_45_eval_faithfulness took 30.333s
[TIME] task_45_eval_readability took 1.286s
[TIME] task_45_eval_sentence_coherence took 5.065s
[TIME] task_45_eval_entity_grid took 0.605s
[TIME] task_45_eval_diversity took 0.000s
[TIME] task_45_eval_stopwords took 0.002s
Downloading builder script: 6.14kB [00:00, 23.7MB/s]
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Sending payload to Blazor at http://blazor_service:5055/api/metrics
POST succeeded
{'bookID': '2', 'bookTitle': 'The Phoenix and the Carpet', 'summaryText': 'The Phoenix, ruffling its golden feathers, denounces an inaccurate book about it and calls for its destruction. It rejects the purple-body and “worm-from-the-ashes” myths, shows its tail to children as proof, and explains the true cycle: like other respectable birds, it builds a pile of sweet woods and aromatic gums, kindles it by wafting its wings, lays an egg, goes to sleep, then wakes inside the egg, emerges renewed, and repeats this forever. At times it admits weariness and a longing for repose.', 'goldSummaryText': '‘The size of an eagle,’ Cyril went on, ‘its head finely crested with a beautiful plumage, its neck covered with feathers of a gold colour, and the rest of its body purple; only the tail white, and the eyes sparkling like stars. They say that it lives about five hundred years in the wilderness, and when advanced in age it builds itself a pile of sweet wood and aromatic gums, fires it with the wafting of its wings, and thus burns itself; and that from its ashes arises a worm, which in time grows up to be a Phoenix. Hence the Phoenicians gave—’\n‘Never mind what they gave,’ said the Phoenix, ruffling its golden feathers. ‘They never gave much, anyway; they always were people who gave nothing for nothing. Tha', 'metrics': {'prF1Metrics': [{'name': 'BERTScore', 'precision': 0.858447253704071, 'recall': 0.8394279479980469, 'f1Score': 0.8488309979438782}], 'qa': {'qaItems': [{'question': 'UNKNOWN', 'goldAnswer': 'UNKNOWN', 'generatedAnswer': 'UNKNOWN', 'isCorrect': False, 'accuracy': 0}, {'question': 'UNKNOWN', 'goldAnswer': 'UNKNOWN', 'generatedAnswer': 'UNKNOWN', 'isCorrect': False, 'accuracy': 0}], 'averageAccuracy': 0}, 'scalarMetrics': [{'name': 'BooookScore (Chang 2024)', 'value': 1}, {'name': 'QuestEval (Scialom 2021)', 'value': 0.28227146717290236}, {'name': 'ROUGE-1', 'value': 0.3963133640552995}, {'name': 'ROUGE-2', 'value': 0.11162790697674418}, {'name': 'ROUGE-L', 'value': 0.2580645161290323}, {'name': 'ROUGE-Lsum', 'value': 0.30414746543778803}]}, 'qaResults': []}
[TIME] task_40_post_payload took 30.275s

Output sent to web app.
[TIME] pipeline_E took 86.698s
[PIPELINE FINALIZED] Story 1 fully processed

=== TIMING SUMMARY ===
                                       calls       total         avg         min         max
function
pipeline_A                                 1    1.790504    1.790504    1.790504    1.790504
pipeline_B                                 1  229.727506  229.727506  229.727506  229.727506
pipeline_C                                 1    9.971251    9.971251    9.971251    9.971251
pipeline_D                                 1   43.923090   43.923090   43.923090   43.923090
pipeline_E                                 1   86.697863   86.697863   86.697863   86.697863
task_01_convert_epub                       1    1.684466    1.684466    1.684466    1.684466
task_02_parse_chapters                     1    0.025949    0.025949    0.025949    0.025949
task_03_chunk_story                        1    0.013713    0.013713    0.013713    0.013713
task_11_send_chunk                         1    0.021415    0.021415    0.021415    0.021415
task_12_relation_extraction[openie]        1   49.373930   49.373930   49.373930   49.373930
task_14_validate_llm[langchain]            1  177.897707  177.897707  177.897707  177.897707
task_16_moderate_triples_llm[resolve]      1    2.273544    2.273544    2.273544    2.273544
task_20_send_triples                       1    6.605025    6.605025    6.605025    6.605025
task_22_fetch_subgraph[community]          1    3.283399    3.283399    3.283399    3.283399
task_23_verbalize_triples[context]         1    0.001375    0.001375    0.001375    0.001375
task_30_summarize_llm[langchain]           1   43.865026   43.865026   43.865026   43.865026
task_31_send_summary                       1    0.001491    0.001491    0.001491    0.001491
task_40_post_payload                       1   30.274947   30.274947   30.274947   30.274947
task_45_eval_bertscore                     1   15.545680   15.545680   15.545680   15.545680
task_45_eval_coverage                      1    0.622342    0.622342    0.622342    0.622342
task_45_eval_diversity                     1    0.000419    0.000419    0.000419    0.000419
task_45_eval_entity_grid                   1    0.604794    0.604794    0.604794    0.604794
task_45_eval_faithfulness                  1   30.333431   30.333431   30.333431   30.333431
task_45_eval_jsd                           1    0.009170    0.009170    0.009170    0.009170
task_45_eval_ncd                           1    0.000160    0.000160    0.000160    0.000160
task_45_eval_ngrams                        1    0.023683    0.023683    0.023683    0.023683
task_45_eval_readability                   1    1.285537    1.285537    1.285537    1.285537
task_45_eval_rouge                         1    2.899984    2.899984    2.899984    2.899984
task_45_eval_salience                      1    0.010678    0.010678    0.010678    0.010678
task_45_eval_sentence_coherence            1    5.064906    5.064906    5.064906    5.064906
task_45_eval_stopwords                     1    0.002162    0.002162    0.002162    0.002162
worker_metric_bookscore                    1    6.608875    6.608875    6.608875    6.608875
worker_metric_questeval                    1  315.021475  315.021475  315.021475  315.021475

Total execution time: 1065.465s
[DUMP] Saved time records to './logs/elapsed_time.csv'
[CHART] Saved chart 'Average Function Runtime Across Runs' to ./logs/charts/avg_runtime.png
[CHART] Saved chart 'Saved summary metrics CSV' to ./logs/metrics/chunk_summary.csv
172.18.0.2 - - [09/Dec/2025 20:28:29] "POST /callback HTTP/1.1" 200 -
INFO:werkzeug:172.18.0.2 - - [09/Dec/2025 20:28:29] "POST /callback HTTP/1.1" 200 -
^Cmake[2]: *** [Makefile:77: docker-start] Interrupt
make[1]: *** [Makefile:89: docker-python] Interrupt
make: *** [Makefile:137: docker-python-dev] Interrupt

conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ make docker-copy-logs
Successfully copied 97.8kB to /mnt/c/dsci-cap/capstone/./
conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ docker logs container-bscore
 * Serving Flask app 'worker'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5002
 * Running on http://172.17.0.3:5002
Press CTRL+C to quit
[QUEUED] chunk 'story-1_book-2_chapter-6_p.74132' from Boss: using database 'conan_capstone' and collection 'story_chunks'
172.18.0.8 - - [09/Dec/2025 20:21:47] "POST /tasks/queue HTTP/1.1" 202 -
FINISHED: chunk ID: story-1_book-2_chapter-6_p.74132, result:
{'value': 1.0, 'annotations': {'The Phoenix, ruffling its golden feathers, denounces an inaccurate book about it and calls for its destruction.': {'questions': None, 'types': None}, 'It rejects the purple-body and “worm-from-the-ashes” myths, shows its tail to children as proof, and explains the true cycle: like other respectable birds, it builds a pile of sweet woods and aromatic gums, kindles it by wafting its wings, lays an egg, goes to sleep, then wakes inside the egg, emerges renewed, and repeats this forever.': {'questions': None, 'types': None}, 'At times it admits weariness and a longing for repose.': {'questions': None, 'types': None}}, 'model_used': 'openai-model_gpt-4o'}
conanp@RPI-conanp:/mnt/c/dsci-cap/capstone$ docker logs container-qeval
Downloading: 6.81kB [00:00, 8.33MB/s]
WARNING:root:Downloading language model for the spaCy model.
DEPRECATION: https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.0.0/en_core_web_sm-3.0.0-py3-none-any.whl#egg=en_core_web_sm==3.0.0 contains an egg fragment with a non-PEP 508 name. pip 25.1 will enforce this behaviour change. A possible replacement is to use the req @ url syntax, and remove the egg fragment. Discussion can be found at https://github.com/pypa/pip/issues/13157
Collecting en-core-web-sm==3.0.0
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.0.0/en_core_web_sm-3.0.0-py3-none-any.whl (13.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 13.7/13.7 MB 26.2 MB/s eta 0:00:00
Requirement already satisfied: spacy<3.1.0,>=3.0.0 in /usr/local/lib/python3.8/site-packages (from en-core-web-sm==3.0.0) (3.0.6)
Requirement already satisfied: spacy-legacy<3.1.0,>=3.0.4 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.0.12)
Requirement already satisfied: murmurhash<1.1.0,>=0.28.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.0.13)
Requirement already satisfied: cymem<2.1.0,>=2.0.2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.0.11)
Requirement already satisfied: preshed<3.1.0,>=3.0.2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.0.10)
Requirement already satisfied: thinc<8.1.0,>=8.0.3 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (8.0.17)
Requirement already satisfied: blis<0.8.0,>=0.4.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.7.11)
Requirement already satisfied: wasabi<1.1.0,>=0.8.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.10.1)
Requirement already satisfied: srsly<3.0.0,>=2.4.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.4.8)
Requirement already satisfied: catalogue<2.1.0,>=2.0.3 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.0.10)
Requirement already satisfied: typer<0.4.0,>=0.3.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.3.2)
Requirement already satisfied: pathy>=0.3.5 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.11.0)
Requirement already satisfied: tqdm<5.0.0,>=4.38.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (4.49.0)
Requirement already satisfied: numpy>=1.15.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.24.4)
Requirement already satisfied: requests<3.0.0,>=2.13.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.32.4)
Requirement already satisfied: pydantic<1.8.0,>=1.7.1 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.7.4)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.11.3)
Requirement already satisfied: setuptools in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (75.3.2)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.8/site-packages (from spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (25.0)
Requirement already satisfied: smart-open<7.0.0,>=5.2.1 in /usr/local/lib/python3.8/site-packages (from pathy>=0.3.5->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (6.4.0)
Requirement already satisfied: pathlib-abc==0.1.1 in /usr/local/lib/python3.8/site-packages (from pathy>=0.3.5->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (0.1.1)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2.2.3)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/site-packages (from requests<3.0.0,>=2.13.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (2025.10.5)
Requirement already satisfied: click<7.2.0,>=7.1.1 in /usr/local/lib/python3.8/site-packages (from typer<0.4.0,>=0.3.0->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (7.1.2)
Requirement already satisfied: MarkupSafe>=0.23 in /usr/local/lib/python3.8/site-packages (from jinja2->spacy<3.1.0,>=3.0.0->en-core-web-sm==3.0.0) (1.1.1)
Installing collected packages: en-core-web-sm
Successfully installed en-core-web-sm-3.0.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
✔ Download and installation successful
You can now load the package via spacy.load('en_core_web_sm')







 * Serving Flask app "worker" (lazy loading)
 * Environment: production
   WARNING: This is a development server. Do not use it in a production deployment.
   Use a production WSGI server instead.
 * Debug mode: off
INFO:werkzeug: * Running on http://0.0.0.0:5001/ (Press CTRL+C to quit)
[QUEUED] chunk 'story-1_book-2_chapter-6_p.74132' from Boss: using database 'conan_capstone' and collection 'story_chunks'
INFO:werkzeug:172.18.0.8 - - [09/Dec/2025 20:21:46] "POST /tasks/queue HTTP/1.1" 202 -
Some weights of the model checkpoint at /root/.cache/huggingface/transformers/bert-base-multilingual-cased were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
FINISHED: chunk ID: story-1_book-2_chapter-6_p.74132, result:
{'value': 0.28227146717290236, 'has_reference': False}
Failed to notify boss: HTTPConnectionPool(host='python_service', port=5054): Read timed out. (read timeout=5)